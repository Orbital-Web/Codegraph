{
    "version": "0.1.0",
    "compounds": [
        {
            "name": "CodeGraph (all)",
            "configurations": [
                "CodeGraph CLI",
                "Model Server",
                "Celery Primary",
                "Celery Indexing",
                "Celery Beat",
            ],
            "presentation": {
                "group": "1",
            },
        },
        {
            "name": "Celery (all)",
            "configurations": [
                "Celery Primary",
                "Celery Indexing",
                "Celery Beat",
            ],
            "presentation": {
                "group": "1",
            },
        }
    ],
    "configurations": [
        // run
        {
            "name": "CodeGraph CLI",
            "consoleName": "CLI",
            "type": "debugpy",
            "request": "launch",
            "program": "main.py",
            "cwd": "${workspaceFolder}/backend",
            "envFile": "${workspaceFolder}/.vscode/.env",
            "env": {
                "LOG_LEVEL": "DEBUG",
                "PYTHONUNBUFFERED": "1",
                "PYTHONPATH": "."
            },
            "presentation": {
                "group": "2",
            },
        },
        // model server
        {
            "name": "Model Server",
            "consoleName": "Model Server",
            "type": "debugpy",
            "request": "launch",
            "module": "uvicorn",
            "cwd": "${workspaceFolder}/backend",
            "envFile": "${workspaceFolder}/.vscode/.env",
            "env": {
                "LOG_LEVEL": "DEBUG",
                "PYTHONUNBUFFERED": "1",
                "PYTHONPATH": "."
            },
            "args": [
                "codegraph.model_service.server:app",
                "--host",
                "localhost",
                "--port",
                "9000",
                "--workers",
                "1"
            ],
            "presentation": {
                "group": "2",
            },
        },
        // celery workers
        {
            "name": "Celery Primary",
            "consoleName": "Celery Primary",
            "type": "debugpy",
            "request": "launch",
            "module": "celery",
            "cwd": "${workspaceFolder}/backend",
            "envFile": "${workspaceFolder}/.vscode/.env",
            "env": {
                "LOG_LEVEL": "INFO",
                "PYTHONUNBUFFERED": "1",
                "PYTHONPATH": "."
            },
            "args": [
                "-A",
                "codegraph.celery.workers.primary",
                "worker",
                "--pool=threads",
                "--concurrency=4",
                "--prefetch-multiplier=1",
                "--loglevel=INFO",
                "-Q",
                "celery"
            ],
            "presentation": {
                "group": "2",
            },
        },
        {
            "name": "Celery Indexing",
            "consoleName": "Celery Indexing",
            "type": "debugpy",
            "request": "launch",
            "module": "celery",
            "cwd": "${workspaceFolder}/backend",
            "envFile": "${workspaceFolder}/.vscode/.env",
            "env": {
                "LOG_LEVEL": "INFO",
                "PYTHONUNBUFFERED": "1",
                "PYTHONPATH": "."
            },
            "args": [
                "-A",
                "codegraph.celery.workers.indexing",
                "worker",
                "--pool=threads",
                "--concurrency=4",
                "--prefetch-multiplier=1",
                "--loglevel=INFO",
                "-Q",
                "indexing"
            ],
            "presentation": {
                "group": "2",
            },
        },
        // celery beat
        {
            "name": "Celery Beat",
            "consoleName": "Celery Beat",
            "type": "debugpy",
            "request": "launch",
            "module": "celery",
            "cwd": "${workspaceFolder}/backend",
            "envFile": "${workspaceFolder}/.vscode/.env",
            "env": {
                "LOG_LEVEL": "INFO",
                "PYTHONUNBUFFERED": "1",
                "PYTHONPATH": "."
            },
            "args": [
                "-A",
                "codegraph.celery.workers.beat",
                "beat",
                "--loglevel=INFO"
            ],
            "presentation": {
                "group": "2",
            },
        },
        // test
        {
            "name": "Pytest",
            "consoleName": "Pytest",
            "type": "debugpy",
            "request": "launch",
            "module": "pytest",
            "cwd": "${workspaceFolder}/backend",
            "envFile": "${workspaceFolder}/.vscode/.env",
            "env": {
                "LOG_LEVEL": "DEBUG",
                "PYTHONUNBUFFERED": "1",
                "PYTHONPATH": "."
            },
            "args": [
                "-vv"
                // Specify a specific module/test to run or provide nothing to run all tests
                // tests/unit/cli/test_streaming.py::test_streaming_without_code_blocks
            ],
            "presentation": {
                "group": "3"
            },
        },
    ],
}